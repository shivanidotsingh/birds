<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Birdwatching in Stockholm</title>
 
</head>
<body>
  <h1>Birds Seen in Stockholm</h1>
  <div id="bird-container"></div>

  <div id="modal" class="modal" style="display: none;">
    <div class="modal-content">
      <button class="close-button" onclick="closeModal()">&times;</button>
      <h2 id="modal-name"></h2>
      <p><em id="modal-latin"></em></p>
      <p id="modal-notes"></p>
      <audio controls id="modal-audio"></audio>
      <button class="increment-button" onclick="incrementCount()">👁️</button>
    </div>
  </div>

  <script>
    const localStorageKey = 'birdCounts';
    let currentBird = null;

    let birds = [
      { name: "Blue Tit", count: 16, latin: "Cyanistes caeruleus", audio: "https://xeno-canto.org/sounds/uploaded/SWJCTHRKBD/XC798268-Parus_caeruleus_early_morning_song.mp3", notes: "Seen frequently near window feeders.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/302264841/1200" },
      { name: "Blackbird", count: 10, latin: "Turdus merula", audio: "https://xeno-canto.org/sounds/uploaded/OOECWDJQLV/XC812730-Blackbird%20song%20suburban.mp3", notes: "Includes 2 females.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/264310641/1200" },
      { name: "Fieldfare", count: 7, latin: "Turdus pilaris", audio: "https://xeno-canto.org/sounds/uploaded/UTWJHDYIUY/XC773880-Fieldfare_flight_calls_Norway.mp3", notes: "Common in winter.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/258466161/1200" },
      { name: "Starling", count: 4, latin: "Sturnus vulgaris", audio: "https://xeno-canto.org/sounds/uploaded/HMQCNXUAYR/XC781617-Starling%2C%20Sturnus%20vulgaris%2C%20singing.mp3", notes: "Often in flocks.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/309156211/1200" },
      { name: "Sparrow", count: 4, latin: "Passer domesticus", audio: "https://xeno-canto.org/sounds/uploaded/GFYHDMLCSF/XC781616-House%20Sparrow%2C%20Passer%20domesticus.mp3", notes: "Chirpy and common.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/312481191/1200" },
      { name: "Eurasian Magpie", count: 2, latin: "Pica pica", audio: "https://xeno-canto.org/sounds/uploaded/GKCYLPQAKO/XC794867-Magpie%20calls%202.mp3", notes: "Distinctive call.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/258465881/1200" },
      { name: "Nuthatch", count: 2, latin: "Sitta europaea", audio: "https://xeno-canto.org/sounds/uploaded/BDYHDUIAEX/XC798264-Eurasian_Nuthatch_calls.mp3", notes: "Creeps down trees headfirst.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/246325271/1200" },
      { name: "Eurasian Jay", count: 2, latin: "Garrulus glandarius", audio: "https://xeno-canto.org/sounds/uploaded/KZMPYAVQOL/XC773321-Eurasian_Jay_calling.mp3", notes: "Colorful and loud.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/246325101/1200" },
      { name: "Greenfinch", count: 2, latin: "Chloris chloris", audio: "https://xeno-canto.org/sounds/uploaded/UXCYFHZGDR/XC794866-Greenfinch%20song.mp3", notes: "Bright yellow flashes in flight.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/277825331/1200" },
      { name: "Hawfinch", count: 2, latin: "Coccothraustes coccothraustes", audio: "https://xeno-canto.org/sounds/uploaded/PUKHGNCKUG/XC773879-Hawfinch_Norway.mp3", notes: "Rare and bulky finch.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/302264861/1200" },
      { name: "European Robin", count: 1, latin: "Erithacus rubecula", audio: "https://xeno-canto.org/sounds/uploaded/UWZLJEGNKR/XC781619-European_Robin_song.mp3", notes: "Heard singing early morning.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/302264921/1200" },
      { name: "Common Woodpigeon", count: 4, latin: "Columba palumbus", audio: "https://xeno-canto.org/sounds/uploaded/TTCEKFEUHH/XC781615-Woodpigeon_call.mp3", notes: "Very common in parks.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/246325241/1200" },
      { name: "European Green Woodpecker", count: 1, latin: "Picus viridis", audio: "https://xeno-canto.org/sounds/uploaded/SZPGWNGTLI/XC798261-Eur_Green_Woodpecker.mp3", notes: "Distinctive laughing call.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/270373961/1200" },
      { name: "Great Spotted Woodpecker", count: 1, latin: "Dendrocopos major", audio: "https://xeno-canto.org/sounds/uploaded/WHCKMPAKPT/XC794864-Great_Spotted_Woodpecker.mp3", notes: "Common but shy.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/246325171/1200" },
      { name: "White Wagtail", count: 1, latin: "Motacilla alba", audio: "https://xeno-canto.org/sounds/uploaded/YVQCHNRYHD/XC781620-White%20Wagtail.mp3", notes: "Seen trotting along pavement.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/271547961/1200" },
      { name: "Three-toed Woodpecker", count: 1, latin: "Picoides tridactylus", audio: "https://xeno-canto.org/sounds/uploaded/GDWZKWPIBJ/XC794865-Three-toed_Woodpecker_call.mp3", notes: "Very uncommon.", image: "https://cdn.download.ams.birds.cornell.edu/api/v1/asset/246325221/1200" }
    ];

    function saveCounts() {
      localStorage.setItem(localStorageKey, JSON.stringify(birds.map(b => ({ name: b.name, count: b.count }))));
    }

    function loadCounts() {
      const saved = JSON.parse(localStorage.getItem(localStorageKey));
      if (saved) {
        birds.forEach(bird => {
          const match = saved.find(item => item.name === bird.name);
          if (match) bird.count = match.count;
        });
      }
    }

    function showModal(bird) {
      currentBird = bird;
      document.getElementById('modal-name').innerText = bird.name;
      document.getElementById('modal-latin').innerText = bird.latin;
      document.getElementById('modal-notes').innerText = bird.notes;
      document.getElementById('modal-audio').src = bird.audio;
      document.getElementById('modal').style.display = 'flex';
    }

    function incrementCount() {
      if (currentBird) {
        currentBird.count++;
        saveCounts();
        renderBirdCircles();
        showModal(currentBird);
      }
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }

    function renderBirdCircles() {
      const container = document.getElementById('bird-container');
      container.innerHTML = '';
      const maxCount = Math.max(...birds.map(b => b.count));
      birds.forEach(bird => {
        const circle = document.createElement('div');
        circle.className = 'bird-circle';
        const size = 50 + (bird.count / maxCount) * 150;
        circle.style.width = `${size}px`;
        circle.style.height = `${size}px`;
        circle.style.left = `${Math.random() * (window.innerWidth - size)}px`;
        circle.style.top = `${Math.random() * (window.innerHeight - size - 80)}px`;
        circle.onclick = () => showModal(bird);
        circle.innerHTML = `<img src="${bird.image}" alt="${bird.name}" />`;
        container.appendChild(circle);
      });
    }

    loadCounts();
    renderBirdCircles();
  </script>
</body>
</html>
